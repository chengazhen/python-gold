# 黄金数据获取工具 - 使用说明

## 🎯 功能概述

根据您的需求，工具已经优化为：
- **默认获取全部黄金类型**：首饰黄金、实物黄金、金条
- **数据源固定为新浪财经**：无需选择数据源
- **一键运行**：无需手动选择，直接获取所有数据

## 🚀 快速使用

### 方法1：运行主程序
```bash
python xinlang.py
```

### 方法2：运行数据管理器
```bash
python gold_data_manager.py
```

两种方法都会：
1. 自动从新浪财经获取所有类型黄金数据
2. 解析并分析数据
3. 保存为JSON、Excel格式
4. 生成合并数据文件

## 📊 输出文件

### 各类型独立文件
```
首饰黄金:
- jewelry_gold_latest.json          # 最新数据
- jewelry_gold_latest_analysis.json # 分析结果
- jewelry_gold_latest.xlsx          # Excel格式
- jewelry_gold_latest.html          # 原始网页数据

实物黄金:
- physical_gold_latest.json
- physical_gold_latest_analysis.json
- physical_gold_latest.xlsx
- physical_gold_latest.html

金条:
- gold_bar_latest.json
- gold_bar_latest_analysis.json
- gold_bar_latest.xlsx
- gold_bar_latest.html
```

### 合并数据文件
```
- combined_gold_data.xlsx           # 包含所有类型的Excel文件
  ├── 首饰黄金 (工作表)
  ├── 实物黄金 (工作表)
  ├── 金条 (工作表)
  └── 数据汇总 (工作表)
```

### 带时间戳的备份文件
```
- jewelry_gold_20250917_100936.json
- physical_gold_20250917_100936.json
- gold_bar_20250917_100937.json
```

## 📈 运行示例

```
黄金数据解析工具
========================================
🔄 正在从新浪财经获取所有类型黄金数据...
========================================

📊 正在获取首饰黄金数据...
✅ 成功从新浪财经获取首饰黄金数据
✅ 成功解析 50 条首饰黄金数据

📊 正在获取实物黄金数据...
✅ 成功从新浪财经获取实物黄金数据
✅ 成功解析 50 条实物黄金数据

📊 正在获取金条数据...
✅ 成功从新浪财经获取金条数据
✅ 成功解析 50 条金条数据

==================================================
📈 数据获取汇总
==================================================
📊 各类型数据量:
  • 首饰黄金: 50 条
  • 实物黄金: 50 条
  • 金条: 50 条

🎯 总计获取: 150 条黄金数据
✅ 所有数据已保存到对应的JSON和Excel文件
📁 合并数据已导出到 combined_gold_data.xlsx
```

## 🔧 技术特点

- **自动化**：无需手动选择，一键获取所有数据
- **数据源统一**：只使用新浪财经，确保数据一致性
- **多格式输出**：JSON、Excel、HTML多种格式
- **分类管理**：按黄金类型分别保存和管理
- **数据分析**：自动生成价格统计和趋势分析
- **备份机制**：带时间戳的备份文件

## 💡 优化说明

### 修改前
- 需要手动选择黄金类型（1/2/3）
- 需要选择数据源（1/2/3）
- 只能获取单一类型数据

### 修改后
- 自动获取所有黄金类型
- 固定使用新浪财经数据源
- 一次运行获取全部数据
- 自动生成汇总和对比

## 🎯 适用场景

- **数据收集**：定期获取黄金价格数据
- **价格监控**：跟踪不同类型黄金价格变化
- **市场分析**：比较不同品牌和类型的价格
- **数据备份**：保存历史价格数据

## 📝 注意事项

1. 需要网络连接访问新浪财经
2. 建议安装pandas和openpyxl以支持Excel功能
3. 数据会自动覆盖latest文件，时间戳文件作为备份
4. 如需自定义参数，可以修改代码中的配置

## 🔄 定期运行建议

可以设置定时任务定期运行：
```bash
# 每日上午10点运行
0 10 * * * cd /path/to/gold && python xinlang.py
```

这样就能自动获取最新的黄金价格数据了！
