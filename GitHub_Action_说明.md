# GitHub Action 自动获取黄金数据

## 🎯 功能说明

已创建两个GitHub Action工作流，可以每天自动获取黄金数据并提交到仓库：

1. **完整版**: `daily-gold-data.yml` - 功能丰富，包含详细日志和通知
2. **简化版**: `simple-daily-fetch.yml` - 简单直接，只做核心功能

## 📁 文件位置

```
gold/
├── .github/
│   └── workflows/
│       ├── daily-gold-data.yml      # 完整版工作流
│       └── simple-daily-fetch.yml   # 简化版工作流
└── GitHub_Action_说明.md            # 本说明文件
```

## ⏰ 运行时间

- **自动运行**: 每天北京时间上午10点 (UTC 02:00)
- **手动触发**: 在GitHub仓库的Actions页面可以手动运行

## 🚀 设置步骤

### 1. 上传到GitHub仓库

将整个 `gold` 目录上传到您的GitHub仓库：

```bash
# 初始化git仓库（如果还没有）
git init

# 添加所有文件
git add .

# 提交
git commit -m "初始化黄金数据获取项目"

# 添加远程仓库（替换为您的仓库地址）
git remote add origin https://github.com/您的用户名/您的仓库名.git

# 推送到GitHub
git push -u origin main
```

### 2. 启用GitHub Actions

1. 进入您的GitHub仓库
2. 点击 "Actions" 标签页
3. 如果是第一次使用，点击 "I understand my workflows, go ahead and enable them"
4. 您会看到两个工作流：
   - "每日黄金数据获取" (完整版)
   - "简化版每日黄金数据获取" (简化版)

### 3. 选择使用哪个工作流

**推荐使用简化版** (`simple-daily-fetch.yml`)，因为它：
- 代码简洁
- 运行稳定
- 满足基本需求

如果您想要更详细的功能，可以使用完整版。

### 4. 手动测试

在Actions页面：
1. 选择要测试的工作流
2. 点击 "Run workflow" 按钮
3. 点击 "Run workflow" 确认
4. 等待运行完成，查看结果

## 📊 工作流功能对比

| 功能 | 简化版 | 完整版 |
|------|--------|--------|
| 自动获取数据 | ✅ | ✅ |
| 自动提交代码 | ✅ | ✅ |
| 检测数据变化 | ✅ | ✅ |
| 详细提交信息 | ❌ | ✅ |
| 数据统计 | ❌ | ✅ |
| 生成摘要报告 | ❌ | ✅ |
| 错误处理 | 基础 | 详细 |

## 🔧 自定义设置

### 修改运行时间

编辑 `.github/workflows/*.yml` 文件中的 cron 表达式：

```yaml
schedule:
  # 每天北京时间下午2点 (UTC 06:00)
  - cron: '0 6 * * *'
  
  # 每12小时运行一次
  - cron: '0 */12 * * *'
  
  # 只在工作日运行 (周一到周五)
  - cron: '0 2 * * 1-5'
```

### 修改提交信息

在工作流文件中找到提交部分，修改提交信息格式：

```yaml
git commit -m "📈 黄金数据更新 $(date '+%Y-%m-%d')"
```

## 📋 运行结果

### 成功运行后会：

1. **自动获取**所有类型黄金数据（首饰黄金、实物黄金、金条）
2. **自动生成**以下文件：
   - `*_latest.json` - 最新数据
   - `*_latest_analysis.json` - 分析结果  
   - `*_latest.xlsx` - Excel格式
   - `*_latest.html` - 原始网页
   - `combined_gold_data.xlsx` - 合并数据

3. **自动提交**到仓库，提交信息类似：
   ```
   🔄 自动更新黄金数据 2025-09-17 10:00
   ```

### 查看运行历史

在GitHub仓库的Actions页面可以查看：
- 每次运行的状态（成功/失败）
- 详细的运行日志
- 提交的数据变化

## ⚠️ 注意事项

1. **网络依赖**: 需要访问新浪财经网站，如果网站不可访问会导致失败
2. **数据变化**: 只有当数据真正发生变化时才会提交
3. **仓库权限**: 确保GitHub Actions有写入权限（默认已启用）
4. **运行限制**: GitHub Actions有使用限制，但对于这个简单任务完全够用

## 🔍 故障排除

### 如果Action运行失败：

1. **查看日志**: 在Actions页面点击失败的运行，查看详细错误信息
2. **网络问题**: 可能是新浪财经网站暂时不可访问，等待下次自动运行
3. **权限问题**: 检查仓库的Actions权限设置
4. **代码问题**: 确保 `xinlang.py` 文件在正确位置且可以正常运行

### 手动修复：

如果需要手动修复，可以：
1. 在本地运行 `python xinlang.py` 测试
2. 手动提交修复后的代码
3. 重新触发Action运行

## 🎉 使用建议

1. **首次设置后手动测试一次**，确保工作正常
2. **定期检查运行状态**，确保数据持续更新
3. **根据需要调整运行频率**，避免过于频繁
4. **保持代码更新**，如果新浪财经网站结构变化需要相应调整

现在您就可以享受全自动的黄金数据获取服务了！🚀
